{"paragraphs":[{"text":"import org.apache.spark.sql.Encoders\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\n\t\n\t\tval spark = SparkSession.builder.appName(\"Talgov-Parks\").getOrCreate()\n\t\t\n\t\timport spark.implicits._\n        val tsm = \"yyyy-MM-dd'T'HH:mm:ss.F'Z'\" // \t2006-01-03T00:00:00.000Z\n\n\t\tval table = \"parks\"\n\t\tval datasr = \"/Users/jhernandez/Work/temp/data\" \n\t\tval datain = datasr+\"/inbound/\"\n\t\tval dataout = datasr+\"/outbound/\"+table\n\t\tval dfparktwo = spark.read.format(\"csv\")\n\t\t\t.schema(schema)\n\t\t\t.option(\"header\",\"true\")\n\t\t\t.option(\"delimiter\",\",\")\n\t\t\t.option(\"inferSchema\", \"true\")\n\t\t\t.load(datain)\n\t\t\t.withColumn(\"EDITED\", unix_timestamp($\"EDITED\", tsm).cast(\"timestamp\"))\n\n\t\tdfparktwo.printSchema()\n\t","user":"admin","dateUpdated":"2018-01-09T21:18:08-0500","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.Encoders\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@82ebf44\nimport spark.implicits._\ntsm: String = yyyy-MM-dd'T'HH:mm:ss.F'Z'\ntable: String = parks\ndatasr: String = /Users/jhernandez/Work/temp/data\ndatain: String = /Users/jhernandez/Work/temp/data/inbound/\ndataout: String = /Users/jhernandez/Work/temp/data/outbound/parks\ndfparktwo: org.apache.spark.sql.DataFrame = [X: string, Y: string ... 41 more fields]\nroot\n |-- X: string (nullable = true)\n |-- Y: string (nullable = true)\n |-- OBJECTID: string (nullable = true)\n |-- PARKNUM: string (nullable = true)\n |-- PARKNAME: string (nullable = true)\n |-- ORG_CODE: string (nullable = true)\n |-- ACREAGE: string (nullable = true)\n |-- CATEGORY: string (nullable = true)\n |-- TRAILS: string (nullable = true)\n |-- MANAGER: string (nullable = true)\n |-- ADDRESS: string (nullable = true)\n |-- LABEL: string (nullable = true)\n |-- NOTES: string (nullable = true)\n |-- CENTER: string (nullable = true)\n |-- RESTROOM: string (nullable = true)\n |-- PICNCSHLTR: string (nullable = true)\n |-- PICNCTABLE: string (nullable = true)\n |-- GRILLS: string (nullable = true)\n |-- POTABLEWTR: string (nullable = true)\n |-- DUMPSTATN: string (nullable = true)\n |-- PLAYGROUND: string (nullable = true)\n |-- BASKETBALL: string (nullable = true)\n |-- ATOMCUB: string (nullable = true)\n |-- JRLEAGUE: string (nullable = true)\n |-- SRLEAGUE: string (nullable = true)\n |-- LLFIELD: string (nullable = true)\n |-- SOCCER: string (nullable = true)\n |-- POOL: string (nullable = true)\n |-- TENNIS: string (nullable = true)\n |-- HOTLINK: string (nullable = true)\n |-- TENTCAMP: string (nullable = true)\n |-- RVSPOTS: string (nullable = true)\n |-- ELECTRIC: string (nullable = true)\n |-- BOATRAMP: string (nullable = true)\n |-- EDITED: timestamp (nullable = true)\n |-- CITYCLASS: string (nullable = true)\n |-- XCOORD: string (nullable = true)\n |-- YCOORD: string (nullable = true)\n |-- QUADRANT: string (nullable = true)\n |-- VIDEO: string (nullable = true)\n |-- AUDIO: string (nullable = true)\n |-- IMAGE: string (nullable = true)\n |-- AMENITYLIST: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1515550586680_2677646","id":"20180109-153233_664780774","dateCreated":"2018-01-09T21:16:26-0500","dateStarted":"2018-01-09T21:18:08-0500","dateFinished":"2018-01-09T21:18:17-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9380"},{"text":"dfparktwo.createOrReplaceTempView(\"parks\")","user":"admin","dateUpdated":"2018-01-09T21:18:24-0500","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1515550586681_2292898","id":"20180109-153416_1177576125","dateCreated":"2018-01-09T21:16:26-0500","dateStarted":"2018-01-09T21:18:24-0500","dateFinished":"2018-01-09T21:18:24-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9381"},{"text":"%sql\nSELECT * FROM parks LIMIT 2\n","user":"admin","dateUpdated":"2018-01-09T21:18:28-0500","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":154,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"X\tY\tOBJECTID\tPARKNUM\tPARKNAME\tORG_CODE\tACREAGE\tCATEGORY\tTRAILS\tMANAGER\tADDRESS\tLABEL\tNOTES\tCENTER\tRESTROOM\tPICNCSHLTR\tPICNCTABLE\tGRILLS\tPOTABLEWTR\tDUMPSTATN\tPLAYGROUND\tBASKETBALL\tATOMCUB\tJRLEAGUE\tSRLEAGUE\tLLFIELD\tSOCCER\tPOOL\tTENNIS\tHOTLINK\tTENTCAMP\tRVSPOTS\tELECTRIC\tBOATRAMP\tEDITED\tCITYCLASS\tXCOORD\tYCOORD\tQUADRANT\tVIDEO\tAUDIO\tIMAGE\tAMENITYLIST\n-84.322424091318155\t30.459116158362047\t85\t243\tSan Luis Mission Park\t1\t69.08\t1\tY\tCOT\t1313 San Luis Rd\tSan Luis Mission Park\t \tN\tY\tY\tY\tY\tY\tN\tY\tN\tN\tN\tN\tN\tN\tN\tN\thttp://www.talgov.com/Uploads/Public/Documents/parks/pdf/sanluis_map.pdf\tN\tN\tN\tN\t2006-01-03 00:00:00.0\tCommunity\t2024449.8749\t530687.78621\tNW\tnull\tnull\tnull\tPlayground, Trails, Covered Shelter, Picnic Areas, Barbecue Grills, Restrooms, Potable Water\n-84.281331295551624\t30.442029679511496\t86\t236\tPonce De Leon Park\t1\t0.59\t3\tN\tCOT\t111 Park Ave E\tPonce De Leon Park\t32301\tN\tN\tN\tN\tN\tY\tN\tN\tN\tN\tN\tN\tN\tN\tN\tN\thttp://www.talgov.com/parks/parksHome.aspx\tN\tN\tN\tN\t2013-03-06 00:00:00.0\tMini\t2037409.12523\t524495.959337\tNW\tnull\tnull\tnull\tPotable Water\n"}]},"apps":[],"jobName":"paragraph_1515550586681_2292898","id":"20180109-153434_194817152","dateCreated":"2018-01-09T21:16:26-0500","dateStarted":"2018-01-09T21:18:28-0500","dateFinished":"2018-01-09T21:18:28-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9382"},{"text":"%sql\nSELECT PARKNUM, ACREAGE FROM parks WHERE LLFIELD = 'Y'\n","user":"admin","dateUpdated":"2018-01-09T21:19:08-0500","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"PARKNUM\tACREAGE\n218\t20.77\n219\t8.61\n217\t1.89\n228\t31.96\n225\t31.96\n257\t19.78\n237\t12.44\n215\t13.29\n277\t16.94\n205\t676.34\n201\t304.05\n"}]},"apps":[],"jobName":"paragraph_1515550730711_1165186319","id":"20180109-211850_1789278141","dateCreated":"2018-01-09T21:18:50-0500","dateStarted":"2018-01-09T21:18:57-0500","dateFinished":"2018-01-09T21:18:58-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9383"},{"text":"dfpark.write.mode(\"append\").parquet(dataout + \".parquet\")\n","dateUpdated":"2018-01-09T21:16:26-0500","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1515550586682_3447144","id":"20180109-155454_98139352","dateCreated":"2018-01-09T21:16:26-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9384"},{"text":"// Read the parquet table\nval dfread = spark.read.parquet(dataout+\".parquet\")\ndfread.printSchema()\n// Creates a temporary view using the DataFrame\ndfread.createOrReplaceTempView(\"park\")","dateUpdated":"2018-01-09T21:16:26-0500","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"dfread: org.apache.spark.sql.DataFrame = [X: decimal(10,7), Y: decimal(10,7) ... 41 more fields]\nroot\n |-- X: decimal(10,7) (nullable = true)\n |-- Y: decimal(10,7) (nullable = true)\n |-- OBJECTID: string (nullable = true)\n |-- PARKNUM: string (nullable = true)\n |-- PARKNAME: string (nullable = true)\n |-- ORG_CODE: string (nullable = true)\n |-- ACREAGE: string (nullable = true)\n |-- CATEGORY: string (nullable = true)\n |-- TRAILS: string (nullable = true)\n |-- MANAGER: string (nullable = true)\n |-- ADDRESS: string (nullable = true)\n |-- LABEL: string (nullable = true)\n |-- NOTES: string (nullable = true)\n |-- CENTER: string (nullable = true)\n |-- RESTROOM: string (nullable = true)\n |-- PICNCSHLTR: string (nullable = true)\n |-- PICNCTABLE: string (nullable = true)\n |-- GRILLS: string (nullable = true)\n |-- POTABLEWTR: string (nullable = true)\n |-- DUMPSTATN: string (nullable = true)\n |-- PLAYGROUND: string (nullable = true)\n |-- BASKETBALL: string (nullable = true)\n |-- ATOMCUB: string (nullable = true)\n |-- JRLEAGUE: string (nullable = true)\n |-- SRLEAGUE: string (nullable = true)\n |-- LLFIELD: string (nullable = true)\n |-- SOCCER: string (nullable = true)\n |-- POOL: string (nullable = true)\n |-- TENNIS: string (nullable = true)\n |-- HOTLINK: string (nullable = true)\n |-- TENTCAMP: string (nullable = true)\n |-- RVSPOTS: string (nullable = true)\n |-- ELECTRIC: string (nullable = true)\n |-- BOATRAMP: string (nullable = true)\n |-- EDITED: timestamp (nullable = true)\n |-- CITYCLASS: string (nullable = true)\n |-- XCOORD: string (nullable = true)\n |-- YCOORD: string (nullable = true)\n |-- QUADRANT: string (nullable = true)\n |-- VIDEO: string (nullable = true)\n |-- AUDIO: string (nullable = true)\n |-- IMAGE: string (nullable = true)\n |-- AMENITYLIST: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1515550586682_3447144","id":"20180109-210337_1175191000","dateCreated":"2018-01-09T21:16:26-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9385"},{"text":"%sql\nSELECT * FROM park LIMIT 2","user":"admin","dateUpdated":"2018-01-09T21:19:33-0500","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":154,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"X\tY\tOBJECTID\tPARKNUM\tPARKNAME\tORG_CODE\tACREAGE\tCATEGORY\tTRAILS\tMANAGER\tADDRESS\tLABEL\tNOTES\tCENTER\tRESTROOM\tPICNCSHLTR\tPICNCTABLE\tGRILLS\tPOTABLEWTR\tDUMPSTATN\tPLAYGROUND\tBASKETBALL\tATOMCUB\tJRLEAGUE\tSRLEAGUE\tLLFIELD\tSOCCER\tPOOL\tTENNIS\tHOTLINK\tTENTCAMP\tRVSPOTS\tELECTRIC\tBOATRAMP\tEDITED\tCITYCLASS\tXCOORD\tYCOORD\tQUADRANT\tVIDEO\tAUDIO\tIMAGE\tAMENITYLIST\n-84.3224241\t30.4591162\t85\t243\tSan Luis Mission Park\t1\t69.08\t1\tY\tCOT\t1313 San Luis Rd\tSan Luis Mission Park\t \tN\tY\tY\tY\tY\tY\tN\tY\tN\tN\tN\tN\tN\tN\tN\tN\thttp://www.talgov.com/Uploads/Public/Documents/parks/pdf/sanluis_map.pdf\tN\tN\tN\tN\t2006-01-03 00:00:00.0\tCommunity\t2024449.8749\t530687.78621\tNW\tnull\tnull\tnull\tPlayground, Trails, Covered Shelter, Picnic Areas, Barbecue Grills, Restrooms, Potable Water\n-84.2813313\t30.4420297\t86\t236\tPonce De Leon Park\t1\t0.59\t3\tN\tCOT\t111 Park Ave E\tPonce De Leon Park\t32301\tN\tN\tN\tN\tN\tY\tN\tN\tN\tN\tN\tN\tN\tN\tN\tN\thttp://www.talgov.com/parks/parksHome.aspx\tN\tN\tN\tN\t2013-03-06 00:00:00.0\tMini\t2037409.12523\t524495.959337\tNW\tnull\tnull\tnull\tPotable Water\n"}]},"apps":[],"jobName":"paragraph_1515550586682_3447144","id":"20180109-210428_506060161","dateCreated":"2018-01-09T21:16:26-0500","dateStarted":"2018-01-09T21:19:33-0500","dateFinished":"2018-01-09T21:19:33-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9386"},{"text":"%sql\nSELECT PARKNUM, ACREAGE FROM park WHERE LLFIELD = 'Y'","user":"admin","dateUpdated":"2018-01-09T21:19:40-0500","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"PARKNUM","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"ACREAGE","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"PARKNUM\tACREAGE\n218\t20.77\n219\t8.61\n217\t1.89\n228\t31.96\n225\t31.96\n257\t19.78\n237\t12.44\n215\t13.29\n277\t16.94\n205\t676.34\n201\t304.05\n"}]},"apps":[],"jobName":"paragraph_1515550586682_3447144","id":"20180109-210527_2136559888","dateCreated":"2018-01-09T21:16:26-0500","dateStarted":"2018-01-09T21:19:40-0500","dateFinished":"2018-01-09T21:19:40-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9387"},{"text":"%sql\n","dateUpdated":"2018-01-09T21:16:26-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1515550586682_3447144","id":"20180109-210951_1810517571","dateCreated":"2018-01-09T21:16:26-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9388"}],"name":"levyhernandez/spark-csv-parquet_2","id":"2D5CSWNGH","angularObjects":{"2D1B6PXRK:shared_process":[],"2D1C129MM:shared_process":[],"2D4EYZRV6:shared_process":[],"2D4FZJJY9:shared_process":[],"2D184PJ7C:shared_process":[],"2D28SX2JR:shared_process":[],"2D2AF6176:shared_process":[],"2D1PGADBD:shared_process":[],"2D4KZ1NHB:shared_process":[],"2D4CK5WFW:shared_process":[],"2D2BQ232Q:shared_process":[],"2D3742P2N:shared_process":[],"2D1PU2V44:shared_process":[],"2D23C2748:shared_process":[],"2D3H1AEHC:shared_process":[],"2D2YBWR8E:shared_process":[],"2D4BMXHGH:shared_process":[],"2D2VHZQ5N:shared_process":[],"2D1UCSVH8:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}